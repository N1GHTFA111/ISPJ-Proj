{% extends 'dashboard_admin_base.html' %}

{% block content %}
<div class="container-fluid p-0">

    <div class="mb-3">
        <h1 class="h3 d-inline align-middle" id="page-identifier">Finance</h1>
    </div>
    <div class="row">
        <div class="col-12">

            <div class="card">
                <div class="card-header">
                    <h2 class="">Transactions</h2>

                    <div class="row">
                        <div class="col-md-4">
                            <label for="transactionsTable-start-date" class="form-label">Start Date:</label>
                            <input type="date" id="transactionsTable-start-date" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <label for="transactionsTable-end-date" class="form-label">End Date:</label>
                            <input type="date" id="transactionsTable-end-date" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="transactions-filter-checkbox">
                                <label class="form-check-label" for="transactions-filter-checkbox">
                                    Toggle Date Filter
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">

                        <table id="transactionsTable" class="table table-hover">
                            <thead>
                            <tr>
                                <th scope="col" class="transaction_id">Transaction ID
                                    <button class="btn btn-sm sort-btn" data-column="transaction_id" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="account_id">Account ID
                                    <button class="btn btn-sm sort-btn" data-column="account_id" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="time">Time
                                    <button class="btn btn-sm sort-btn" data-column="time" data-order="">&#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="product_name">Product Name
                                    <button class="btn btn-sm sort-btn" data-column="product_name" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="product_id">Product ID
                                    <button class="btn btn-sm sort-btn" data-column="product_id" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="product_quantity">Quantity
                                    <button class="btn btn-sm sort-btn" data-column="product_quantity" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="unit_price">Unit Price
                                    <button class="btn btn-sm sort-btn" data-column="unit_price" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="total_price">
                                    Total Price
                                </th>
                            </tr>
                            </thead>
                            <tbody class="table-group-divider">
                            {% if transactions %}
                            {% for transaction in transactions %}
                            <tr>
                                <td>{{ transaction.transaction_id }}</td>
                                <td>{{ transaction.account_id }}</td>
                                <td>{{ transaction.time }}</td>
                                <td>{{ transaction.product_name }}</td>
                                <td>{{ transaction.product_id }}</td>
                                <td>{{ transaction.product_quantity }}</td>
                                <td>{{ transaction.unit_price }}</td>
                                <td>{{ transaction.total_price}}</td>
                            </tr>
                            {% endfor %}
                            {% else %}
                            <tr>
                                <td colspan="7">There are currently no transactions.</td>
                            </tr>
                            {% endif %}
                            </tbody>
                        </table>


                    </div>
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center" id="transactionsTable-pagination">
                            <!-- Pagination links will be populated here dynamically using JavaScript -->
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <div class="col-12">

            <div class="card">
                <div class="card-header">
                    <h2 class="">Points</h2>
                    <div class="row">
                        <div class="col-md-4">
                            <label for="pointsTable-start-date" class="form-label">Start Date:</label>
                            <input type="date" id="pointsTable-start-date" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <label for="pointsTable-end-date" class="form-label">End Date:</label>
                            <input type="date" id="pointsTable-end-date" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="points-filter-checkbox">
                                <label class="form-check-label" for="points-filter-checkbox">
                                    Toggle Date Filter
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">

                        <table id="pointsTable" class="table table-hover">
                            <thead>
                            <tr>
                                <th scope="col" class="code_id">Code ID
                                    <button class="btn btn-sm sort-btn" data-column="code_id" data-order="">&#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="time">Time
                                    <button class="btn btn-sm sort-btn" data-column="time" data-order="">&#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="points">Points
                                    <button class="btn btn-sm sort-btn" data-column="points" data-order="">&#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="redemption_code">Redemption Code
                                    <button class="btn btn-sm sort-btn" data-column="redemption_code" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="expiration_date">Expiration
                                    <button class="btn btn-sm sort-btn" data-column="expiration_date" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="claimedBy">Claimed by
                                    <button class="btn btn-sm sort-btn" data-column="claimedBy" data-order="">&#x21C5;
                                    </button>
                                </th>
                            </tr>
                            </thead>
                            <tbody class="table-group-divider" style="max-height:300px;">
                            {% if codes %}
                            {% for code in codes %}
                            <tr>
                                <td>{{ code.code_id }}</td>
                                <td>{{ code.time }}</td>
                                <td>{{ code.points }}</td>
                                <td>{{ code.redemption_code }}</td>
                                <td>{{ code.expiration_date }}</td>
                                <td>
                                    {% if code.claimedBy %}
                                    {{ code.claimedBy }}
                                    {% else %}
                                    -
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                            {% else %}
                            <tr>
                                <td colspan="5">There are currently no points to claim.</td>
                            </tr>
                            {% endif %}
                            </tbody>
                        </table>


                    </div>
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center" id="pointsTable-pagination">
                            <!-- Pagination links will be populated here dynamically using JavaScript -->
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <div class="col-12">

            <div class="card">
                <div class="card-header">
                    <h2 class="">Vouchers Redeemed</h2>

                    <div class="row">
                        <div class="col-md-4">
                            <label for="redeemedVouchersTable-start-date" class="form-label">Start Date:</label>
                            <input type="date" id="redeemedVouchersTable-start-date" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <label for="redeemedVouchersTable-end-date" class="form-label">End Date:</label>
                            <input type="date" id="redeemedVouchersTable-end-date" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="redeemed-vouchers-filter-checkbox">
                                <label class="form-check-label" for="redeemed-vouchers-filter-checkbox">
                                    Toggle Date Filter
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">

                        <table id="redeemedVouchersTable" class="table table-hover">
                            <thead>
                            <tr>
                                <th scope="col" class="voucher_transaction_id">Voucher Transaction ID</th>
                                <th scope="col" class="time">Time
                                    <button class="btn btn-sm sort-btn" data-column="time" data-order="">&#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="voucher_cart_id">Voucher Cart ID
                                    <button class="btn btn-sm sort-btn" data-column="voucher_id" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                                <th scope="col" class="redeemedBy">Redeemed by
                                    <button class="btn btn-sm sort-btn" data-column="redeemedBy" data-order="">
                                        &#x21C5;
                                    </button>
                                </th>
                            </tr>
                            </thead>
                            <tbody class="table-group-divider">
                            {% if vouchers_redeemed %}
                            {% for voucher in vouchers_redeemed %}
                            <tr>
                                <td>{{voucher.voucher_transaction_id}}</td>
                                <td>{{ voucher.time }}</td>
                                <td>{{ voucher.voucher_cart_id }}</td>
                                <td>{{ voucher.redeemedBy }}</td>
                            </tr>
                            {% endfor %}
                            {% else %}
                            <tr>
                                <td colspan="3">There are currently no vouchers redeemed.</td>
                            </tr>
                            {% endif %}
                            </tbody>
                        </table>


                    </div>
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center" id="redeemedVouchersTable-pagination">
                            <!-- Pagination links will be populated here dynamically using JavaScript -->
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const codes = {{ codes | tojson }};
  const voucherRedemptions = {{ vouchers_redeemed | tojson }};
  const transactions = {{ transactions | tojson }};


</script>
<script src="{{ url_for('static', filename='js/financeTables.js') }}" defer></script>


{% endblock %}
